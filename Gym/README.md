# Прогнозирование вероятности оттока пользователей для фитнес-центров

## Цели исследования
1. Спрогнозировать вероятность оттока для каждого клиента в следующем месяце
2. Сформировать портреты пользователей с помощью кластеризации 

## Данные
- gender — пол;
- Near_Location — проживание или работа в районе, где находится фитнес-центр;
- Partner — сотрудник компании-партнёра клуба (сотрудничество с компаниями, чьи сотрудники могут получать скидки на абонемент — в таком случае фитнес-центр хранит информацию о работодателе клиента);
- Promo_friends — факт первоначальной записи в рамках акции «приведи друга» (использовал промо-код от знакомого при оплате первого абонемента);
- Phone — наличие контактного телефона;
- Age — возраст;
- Lifetime — время с момента первого обращения в фитнес-центр (в месяцах).
- Contract_period — длительность текущего действующего абонемента (месяц, 6 месяцев, год);
- Month_to_end_contract — срок до окончания текущего действующего абонемента (в месяцах);
- Group_visits — факт посещения групповых занятий;
- Avg_class_frequency_total — средняя частота посещений в неделю за все время с начала действия абонемента;
- Avg_class_frequency_current_month — средняя частота посещений в неделю за предыдущий месяц;
- Avg_additional_charges_total — суммарная выручка от других услуг фитнес-центра: кафе, спорттовары, косметический и массажный салон.
- Churn — факт оттока в текущем месяце.
 
## Этапы исследования
1. Изучение и предобработка данных
2. Исследовательский анализ данных
   1) первичная оценка параметров данных
   2) средние значения и распределение признаков в группе оставшихся клиентов и в группе ушедших
   3) матрица корреляций признаков
3. Модель прогнозирования оттока клиентов
   1) распределение признаков, их стандартизация
   2) создание и обучение моделей, расчет метрик и сравнение моделей
4. Кластеризация клиентов
   1) с использованием дендрограммы
   2) методом K-means
5. Выводы и рекомендации

## Выводы и рекомендации
### Исследовательский анализ данных (EDA)
- **gender:** количество клиентов с полом 1 составляет 51%, в целом, можно сказать, что деление 50 на 50.
- **near_location:** количество клиентов,  у которых фитнес центр находится в районе проживания / работы составляет 84,5%.
- **partner:** 48,7% клиентов пришли со скидкой от компании-партнера клуба.
- **promo_friends:** 30% клиентов пришли по акции Приведи друга.  
- **phone:** 90% клиентов указали номер телефона. 
- **contract_period:** средняя длительность текущего абонемента у клиентов составляет 4.68 месяцев
- **group_visits:** количество клиентов, которые посещают групповые занятия составляет 41,2%.
- **age:** средний возраст клиентов фитнес-клуба - 29 лет,
- **avg_additional_charges_total**: средняя суммарная выручка от других услуг фитнес-центра составялет 146.9 у.е.
- **month_to_end_contract:** средний срок до оконачания текущего абонемента составляет 4.32 месяца, медиана составляет - 1 месяц. В целом цифры совпадают с аналогичными по сроку контракта.
- **lifetime:** средний "срок жизни" текущих клиентов составляет - 3.72 месяца,
- **avg_class_frequency_total:** средняя частота посещений в неделю за весь срок действия абонемента составляет - 1.88 шт.,
- **avg_class_frequency_current_month:** средняя частота посещений в неделю за текущий месяц составляет - 1.77 шт.,
- **churn:** отток клиентов за текущий месяц составляет 26.5%.

#### Средние значения и распределение признаков в группе оставшихся клиентов и в группе ушедших
Те, кто остался:
* примерно одинаковые по соотношению полов, номеров телефонов с теми, кто ушел
* чаще живут/работают рядом со спортзалом
* чаще **работают в компании-партнере фитнесс-центра**
* чаще пришли **по программе Приведи друга**
* имеют **более длительный контракт** и более длительный срок до окончания контакта, а также более длинный lifetime
* чаще **посещают групповые занятия**
* более зрелые (но в среднем разница всего 3 года)
* чаще оплачивают дополнительные услуги
* чаще посещают групповые занятия (2 в неделю), те, кто уходят - меньше 1.5.  **Посещение групповых занятий в текущем месяце у них такое же, как и в предущие**. При этом, у тех, кто уйдет, оно снизилось.
Диаграммы рассеяния и столбчатые диаграммы подтверждают выводы, сделанные по средним значениям.
**Особенно следует отметить, что снижение среднего числа посещений групповых занятий в неделю, является "спутником" ухода клиента.**

#### Матрица корреляций признаков

2 параметра с очень сильной корреляцией - contract_period и month_to_end_contract_period. 
После удаления одного из мультиколлинеарных столбцоы по матрице корреляций можно отметить, что уровень оттока положительно зависит от пола и отрицательно от других параметров. Особенно на уровень оттока влияет возраст клиента. Пол оказывает наименьшее влияние.

### Модель прогнозирования оттока клиентов
#### Создание и обучение моделей, расчет метрик и сравнение моделей
Прогнозирование оттока клиентов произведено 2 моделями: логистической регресией и случайным лесом. По признаку Accuracy модель идентичны, но по признакам Precision и Recall, получается, что более точная модель Logistic Regression. Соответственно, для дальнейшего прогнозирования рекомендуется использовать логистическую регрессию.

### Кластеризация клиентов
#### Кластеризация с использованием дендрограммы
C использованием дендрограммы мы можем выделить 5 разных классов клиентов. 

#### Кластеризация методом K-means
После кластеризации методом K-means с числом кластеров 5 основные отличия между кластерами выглядят так:
- 0 кластер - живут далеко, половина пришла по скидке работодателя, молодой возраст, лайфтайм средний
- 1 кластер - длительный контракт + частое посещение групповых, скидки
- 2 кластер - молодые, активно посещают групповые, но тратят мало внутри. Без скидки Приведи друга или от работодателя
- 3 кластер - без скидки, зрелые, много тратят внутри, часто посещают групповые
- 4 кластер - длительный контракт + редкое посещение групповых, скидки

### Предложения по удержанию клиентов различных кластеров

**0 кластер**<br>
Высокий уровень оттока<br>
Основная проблема - расстояние и отсутствие скидки у тех, кто пришел не от работодателя
Варианты решения:
- проанализировать местоположение работодателя и ближайшего транспортного узла, организовать транспорт от/до места работы/транспортного узла
- предложить нестандартные часы работы, чтобы клиенты успевали позаниматься до работы/учебы/других дел
- дополнительная скидка на следующий период
На мой взгляд, все варианты очень затратны и, возможно, нерентабельны.

**1 кластер**<br>
Низкий уровень оттока, проблем не наблюдается.<br>
Дополнительные меры, чтобы обеспечивать интерес этой группы:
- добавлять новые "модные" групповые занятия
- предложить нестандартную длительность групповой тренировки в дневное время в рабочие дни, например, 40-45 минут, чтобы клиенты успевали позаниматься в обеденный перерыв
- дополнительные скидки на покупку "длинных абонементов"

**2 кластер**<br>
Максимальный уровень оттока.<br>
Основные проблемы: отсутствие скидки, юный возраст, возможно, низкие доходы
Дополнительные меры, чтобы обеспечивать интерес этой группы:
- добавлять новые "модные" групповые занятия
- предлагать рассрочку на длительные абонементы
- расширить ассортимент дополнительных услуг, предложив "хайповые" среди молодежи (те, которых нет)
- геймификация: есть минимальная скидка на следующий абонемент, но ее можно увеличить за счет активного посещения групповых / покупки дополнительных услуг
- скидка за нестандартное время (дневные часы в будни)

**3 кластер**<br>
Низкий уровень оттока.<br>
Дополнительные меры, чтобы обеспечивать интерес этой группы:
- не похоже, что скидки для этой группы будут иметь значение, надо сосредотачиваться на качестве и количестве услуг
- добавлять новые "модные" групповые занятия
- расширять ассортимент дополнительных услуг

**4 кластер**<br>
Низкий уровень оттока.<br>
Дополнительные меры, чтобы обеспечивать интерес этой группы:
- тк у этой группы достачно редкое посещение групповых, надо обратить внимание на другие форматы тренировки (тренажерный зал, бассейн?). 
- дополнительные скидки на покупку "длинных абонементов"
- расширять ассортимент дополнительных услуг

## Используемые бибилиотеки
pandas, matplotlib, numpy, seaborn, scipy, sklearn
